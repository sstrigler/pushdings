<!DOCTYPE HTML>
<html>
  <head>
    <script type="text/javascript">
var ws = new Object;

function send()
{
    ws.send("hello world!");
    console.log('Message sent');
    return true;
}

function connect() {
    if (!("WebSocket" in window)) {
        alert("This browser does not support WebSockets");
    }

    var appid = prompt("Which app id?", "123");

    /* @todo: Change to your own server IP address */
    ws = new WebSocket("ws://localhost:8080/ws", "pushdings_v1");
    ws.onopen = function() {
        console.log('Connected');
        ws.send(JSON.stringify(
            {app_id: appid, user_id: "user_123", user_token: "my_token"}));
    };
    ws.onmessage = function (evt)
    {
        var received_msg = evt.data;
        console.log("Received: " + received_msg);
        var text = document.createTextNode("Simon says: " + received_msg);
        var div  = document.createElement("div");
        div.appendChild(text);
        document.getElementById('msgs').appendChild(div);
    };
    ws.onclose = function()
    {
        console.log('Connection closed');
    };
    return false;
}
onload  = function() {
    document.getElementById('connect_button').focus();
};
    </script>
  </head>
  <body>
    <div id="sse">
      <button onclick="return connect()" href='#' id="connect_button">Open websocket connection</button><br/>
    </div>
    <div id="msgs">
    </div>
  </body>
</html>
